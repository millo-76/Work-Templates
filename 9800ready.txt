service timestamps debug datetime msec
service timestamps log datetime msec
no service pad
service password-encryption
secure boot-image
secure boot-config
security passwords min-length 12
no ip http server
no ip http secure-server
no ip source-route
no cdp run
no lldp run

hostname $WLCName$
ip domain-name uccs.edu
crypto key generate rsa modulus 2048
ip ssh version 2
ip ssh time-out 60
ip ssh authentication-retries 2

aaa new-model
aaa authentication dot1x default group radius
aaa authorization network default group radius
aaa accounting update periodic 5
aaa accounting exec default start-stop group radius
aaa accounting system default start-stop group radius

radius-server host $RadiusServer$ auth-port 1812 acct-port 1813 key $RadiusKey$
ip radius source-interface Vlan99

dot1x system-auth-control

username admin privilege 15 secret $SuperSecretPassword$

line con 0
 exec-timeout 10 0
 logging synchronous
 login local

line vty 0 4
 access-class MGMT_ACCESS in
 exec-timeout 10 0
 login local
 transport input ssh

ip access-list standard MGMT_ACCESS
 permit $MgmtSubnet$
 deny any log

vlan 10
 name $VLANname$
vlan 20
 name $VLANname$
vlan 30
 name $VLANname$
vlan 99
 name $VLANname$

interface GigabitEthernet1/0/1
 description Trunk to Access Point
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk allowed vlan 10,20,30
 spanning-tree portfast trunk
 spanning-tree bpduguard enable
 storm-control broadcast level 1.00
 storm-control action shutdown
 service-policy input MARKING
 mtu 1500

define interface-template DOT1X_ACCESS
 switchport mode access
 switchport access vlan 30
 switchport voice vlan 20
 switchport port-security
 switchport port-security maximum 2
 switchport port-security violation restrict
 switchport port-security mac-address sticky
 authentication port-control auto
 authentication periodic
 authentication timer reauthenticate server
 dot1x pae authenticator
 mab
 spanning-tree portfast
 spanning-tree bpduguard enable
 spanning-tree guard root
 storm-control broadcast level 1.00
 storm-control action shutdown
 service-policy input MARKING
 ip dhcp snooping trust

ip dhcp snooping
ip dhcp snooping vlan 10,20,30
ip dhcp snooping verify mac-address
no ip dhcp snooping information option
ip arp inspection vlan 10,20,30

no snmp-server community public
no snmp-server community private

snmp-server group SECURE v3 priv
snmp-server user admin SECURE v3 auth sha $AuthPass$ priv aes 256 $PrivPass$
snmp-server enable traps
snmp-server contact $SNMPserver$
snmp-server location MDF-Closet1

logging buffered 64000 debugging
logging trap informational
logging host $SyslogServer$
service sequence-numbers

archive
 log config
  logging enable
  notify syslog
  hidekeys

ntp authentication-key 1 md5 $NTPAuthKey$ 7
ntp authenticate
ntp trusted-key 1
ntp server $NTPServer$ key 1 prefer

ip flow-export version 9
flow exporter CampusFlow
 destination $FlowCollector$
 source Vlan99
 transport udp 9996
 template data timeout 60

flow monitor UserMonitor
 exporter CampusFlow
 record netflow-original
 cache timeout active 60

interface Vlan99
 ip flow monitor UserMonitor input

control-plane
 service-policy input CONTROL_PLANE_POLICY
!
class-map match-any CONTROL_PLANE_MATCH
 match protocol ssh
 match protocol snmp
 match protocol ntp
 match protocol ospf
!
policy-map CONTROL_PLANE_POLICY
 class CONTROL_PLANE_MATCH
  police 64000 8000 conform-action transmit exceed-action drop